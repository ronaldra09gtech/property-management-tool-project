import{c as N,s as u,b as k,R as l,j as e,U as D,X as S}from"./index-Balmp9Wm.js";import{u as E,a as g}from"./useMutation-Dpa1Kpty.js";import{P as A}from"./plus-C5Q0bYA9.js";import{A as C}from"./alert-circle-B3Q1vRIz.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=N("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);async function q(){const{data:s,error:a}=await u.from("departments").select("*").order("name");if(a)throw console.error("Error fetching departments:",a),new Error("Failed to fetch departments");return s}async function M(s){const{data:a,error:n}=await u.from("departments").insert([{name:s.name,description:s.description,status:s.status}]).select().single();if(n)throw console.error("Error creating department:",n),new Error("Failed to create department");return a}async function I(s){const{error:a}=await u.from("departments").delete().eq("id",s);if(a)throw console.error("Error deleting department:",a),new Error("Failed to delete department")}function R(){const s=k(),[a,n]=l.useState(!1),[x,h]=l.useState(!1),[r,d]=l.useState({name:"",description:"",status:"active"}),[p,i]=l.useState(null),[f,c]=l.useState(null),{data:o,isLoading:y}=E({queryKey:["departments"],queryFn:q}),j=g({mutationFn:M,onSuccess:()=>{s.invalidateQueries({queryKey:["departments"]}),n(!1),d({name:"",description:"",status:"active"}),c("Department created successfully"),setTimeout(()=>c(null),3e3)},onError:t=>{console.error("Error creating department:",t),i((t==null?void 0:t.message)||"Failed to create department. Please try again."),setTimeout(()=>i(null),3e3)},onSettled:()=>{h(!1)}}),b=g({mutationFn:I,onSuccess:()=>{s.invalidateQueries({queryKey:["departments"]}),c("Department deleted successfully"),setTimeout(()=>c(null),3e3)},onError:t=>{console.error("Error deleting department:",t),i((t==null?void 0:t.message)||"Failed to delete department. Please try again."),setTimeout(()=>i(null),3e3)}}),w=async t=>{if(t.preventDefault(),!r.name.trim()){i("Department name is required");return}h(!0),i(null);try{await j.mutateAsync(r)}catch(m){console.error("Error creating department:",m)}},v=async t=>{if(window.confirm("Are you sure you want to delete this department?"))try{await b.mutateAsync(t)}catch(m){console.error("Error deleting department:",m)}};return y?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Departments"}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(A,{className:"h-5 w-5 mr-2"}),"Add Department"]})]}),p&&e.jsx("div",{className:"mb-4 p-4 rounded-md bg-red-50",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:p})})]})}),f&&e.jsx("div",{className:"mb-4 p-4 rounded-md bg-green-50",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(F,{className:"h-5 w-5 text-green-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:f})})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o==null?void 0:o.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-indigo-100",children:e.jsx(D,{className:"h-5 w-5 text-indigo-600"})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.description})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>v(t.id),className:"text-red-600 hover:text-red-900",children:"Delete"})})]},t.id))})]})}),a&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[e.jsx("div",{className:"absolute top-0 right-0 pt-4 pr-4",children:e.jsx("button",{onClick:()=>n(!1),className:"bg-white rounded-md text-gray-400 hover:text-gray-500",children:e.jsx(S,{className:"h-6 w-6"})})}),e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Add Department"}),e.jsxs("form",{onSubmit:w,className:"mt-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",id:"name",required:!0,value:r.name,onChange:t=>d({...r,name:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",rows:3,value:r.description,onChange:t=>d({...r,description:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",name:"status",value:r.status,onChange:t=>d({...r,status:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",disabled:x,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Adding...":"Add Department"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})]})]})})]})}export{R as default};
